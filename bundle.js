(()=>{"use strict";var t={198:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Analyzer=void 0,e.Analyzer=class{constructor(t){this.table=t,this.coinsLeftRow=new Uint8Array(5),this.coinsLeftCol=new Uint8Array(5),this.voltsLeftRow=new Uint8Array(5),this.voltsLeftCol=new Uint8Array(5)}start(){this.table.lockInputs(),this.updateFlagsInitial()}getIndices(t){const e=[];return 1&t&&e.push(1),2&t&&e.push(2),4&t&&e.push(3),8&t&&e.push(4),e}getPossibleFlags(t,e,s){let l=0;return s&&(l|=1),e&&(e+s>=t+2&&e+3*s<=3*t-0&&(l|=8),e+s>=t+1&&e+3*s<=3*t-1&&(l|=4),e+s>=t+0&&e+3*s<=3*t-2&&(l|=2)),l}checkFlagsAndSolve(t,e,s,l){const n=this.getIndices(s);if(1===n.length&&(this.table.solve(t,e,n[0]),l?.push({x:t,y:e})),0===n.length)throw new Error("Impossible initial value, check your input");console.log("processing",t,e,s)}updateFlagsCross(t,e,s){const l={row:this.table.coinsRow(e),col:this.table.coinsCol(t)},n={row:this.table.voltsRow(e),col:this.table.voltsCol(t)},o=new Set([0,1,2,3,4]),i=new Set([0,1,2,3,4]),a=(t,e)=>1===e?(n[t]-=1,!0):e>1&&(l[t]-=e-1,!0);for(const t of o.keys()){const s=this.table.outputAt(t,e);(a("row",s.selectedValue)||a("row",s.solvedValue))&&o.delete(t)}for(const e of i.keys()){const s=this.table.outputAt(t,e);(a("col",s.selectedValue)||a("col",s.solvedValue))&&i.delete(e)}const c=this.getPossibleFlags(o.size,l.row,n.row),r=this.getPossibleFlags(i.size,l.col,n.col),u=[];for(const t of o.keys()){const s=this.table.outputAt(t,e).possibleValues&c;this.table.setFlag(t,e,s),this.checkFlagsAndSolve(t,e,s,u)}for(const e of i.keys()){const s=this.table.outputAt(t,e).possibleValues&r;this.table.setFlag(t,e,s),this.checkFlagsAndSolve(t,e,s,u)}for(const t of u)this.updateFlagsCross(t.x,t.y,0)}updateFlagsInitial(){const t=[];for(let e=0;e<5;e++){const s=this.table.coinsRow(e),l=this.table.voltsRow(e);for(let n=0;n<5;n++){const o=this.table.coinsCol(n),i=this.table.voltsCol(n),a=this.getPossibleFlags(5,s,l)&this.getPossibleFlags(5,o,i);this.table.setFlag(n,e,a),this.checkFlagsAndSolve(n,e,a,t)}}for(const e of t)this.updateFlagsCross(e.x,e.y,0)}}},220:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Table=void 0;const l=s(593);class n{constructor(t){this.cellType="input",this.element=document.createElement("td"),this.inputCoins=document.createElement("input"),this.inputVolts=document.createElement("input"),this.canChangeInternal=!0,this.onEnterPressed=l.noopFunc,this.inputCoins.type="number",this.inputCoins.value="0",this.inputCoins.min="0",this.inputCoins.max="15",this.inputCoins.addEventListener("keydown",(t=>{"Enter"===t.key&&(this.inputCoins.value=(0,l.clamp)(this.coins,0,15).toString(),this.inputCoins.blur(),this.inputVolts.select())})),this.inputVolts.type="number",this.inputVolts.value="0",this.inputVolts.min="0",this.inputVolts.max="5",this.inputVolts.addEventListener("keydown",(t=>{"Enter"===t.key&&(this.inputVolts.value=(0,l.clamp)(this.volts,0,5).toString(),this.inputVolts.blur(),this.onEnterPressed())})),this.element.append(this.inputCoins,this.inputVolts),t.appendChild(this.element)}focus(){this.inputCoins.select()}get coins(){return parseInt(this.inputCoins.value)||0}get volts(){return parseInt(this.inputVolts.value)||0}get canChange(){return this.canChangeInternal}set canChange(t){this.inputCoins.disabled=!t,this.inputVolts.disabled=!t,this.canChangeInternal=t}}class o{constructor(t,e){this.onSelectChange=e,this.cellType="analyze",this.element=document.createElement("td"),this.possibleValuesInternal=15,this.canSelectInternal=!1,this.solvedValueInternal=0,this.selectedValue=0,this.btnV=this.createButton(1,"0"),this.btn1=this.createButton(2,"1"),this.btn2=this.createButton(3,"2"),this.btn3=this.createButton(4,"3"),t.appendChild(this.element),this.canSelect=!1}createButton(t,e){const s=document.createElement("button");return s.onclick=()=>{this.onSelectChange(this.selectedValue=t),this.updateButtonsStatus()},s.innerText=e,s.classList.add("analyze"),this.element.appendChild(s),s}updateButtonsStatus(){this.updateButtonStatus(this.btnV,1,1),this.updateButtonStatus(this.btn1,2,2),this.updateButtonStatus(this.btn2,4,3),this.updateButtonStatus(this.btn3,8,4)}updateButtonStatus(t,e,s){const l=!!(e&this.possibleValuesInternal),n=s===this.selectedValue;t.disabled=this.canSelectInternal||!l,1===s?t.classList.add("voltorb"):t.classList.remove("voltorb"),this.solvedValueInternal?this.solvedValueInternal===s?(t.classList.add("selected"),t.classList.remove("impossible")):(t.classList.remove("voltorb"),t.classList.remove("selected"),t.classList.add("impossible")):(1===s?t.classList.add("voltorb"):t.classList.remove("voltorb"),l?t.classList.remove("impossible"):t.classList.add("impossible"),n?t.classList.add("selected"):t.classList.remove("selected"))}get canSelect(){return this.canSelectInternal}set canSelect(t){this.canSelectInternal=t,this.updateButtonsStatus()}get possibleValues(){return this.possibleValuesInternal}set possibleValues(t){this.possibleValuesInternal=t,this.updateButtonsStatus()}get solvedValue(){return this.solvedValueInternal}solve(t){this.solvedValueInternal=t,this.updateButtonsStatus()}}class i{constructor(){this.element=document.createElement("tr"),this.cells=[],this.lastEnterPress=l.noopFunc}static createInputCell(t){const e=new n(t.element);this.previousInputCell&&(this.previousInputCell.onEnterPressed=()=>e.focus()),t.cells.push(e),this.previousInputCell=e}static createGoButton(t,e){const s=document.createElement("button");s.innerText="Go!",s.style.width="48px",s.style.height="48px",s.onclick=()=>e();const l=document.createElement("td");return l.appendChild(s),t.appendChild(l),s}static createRowCells(t,e){const s=new this;t.appendChild(s.element);for(let t=0;t<5;t++)s.cells.push(new o(s.element,(s=>e(t,s))));return this.createInputCell(s),s}static createColCells(t,e){const s=new this;t.appendChild(s.element);for(let t=0;t<5;t++)this.createInputCell(s);const l=this.createGoButton(s.element,e);return this.previousInputCell.onEnterPressed=()=>l.click(),s}}e.Table=class{constructor(t){this.element=document.createElement("table"),this.rows=[],this.goFunc=l.noopFunc,this.onSelect=l.noopFunc;for(let t=0;t<5;t++)this.rows.push(i.createRowCells(this.element,((e,s)=>this.onSelect(e,t,s))));this.rows.push(i.createColCells(this.element,(()=>this.goFunc()))),t.appendChild(this.element)}coinsRow(t){return this.rows[t].cells[5].coins}voltsRow(t){return this.rows[t].cells[5].volts}coinsCol(t){return this.rows[5].cells[t].coins}voltsCol(t){return this.rows[5].cells[t].volts}outputAt(t,e){return this.rows[e].cells[t]}lockInputs(){for(let t=0;t<5;t++)this.rows[t].cells[5].canChange=!1;for(let t=0;t<5;t++)this.rows[5].cells[t].canChange=!1}setFlag(t,e,s){this.rows[e].cells[t].possibleValues=s}solve(t,e,s){this.rows[e].cells[t].solve(s)}}},593:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.clamp=e.noopFunc=void 0,e.noopFunc=()=>{},e.clamp=function(t,e,s){return Math.max(Math.min(t,s),e)}}},e={};function s(l){var n=e[l];if(void 0!==n)return n.exports;var o=e[l]={exports:{}};return t[l](o,o.exports,s),o.exports}(()=>{const t=s(198),e=new(s(220).Table)(document.body),l=new t.Analyzer(e);e.goFunc=()=>l.start(),e.onSelect=(t,e,s)=>l.updateFlagsCross(t,e,s)})()})();